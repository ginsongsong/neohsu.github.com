<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Android | Learn Or Die]]></title>
  <link href="http://NeoHsu.github.io/blog/categories/android/atom.xml" rel="self"/>
  <link href="http://NeoHsu.github.io/"/>
  <updated>2013-12-13T11:48:06+08:00</updated>
  <id>http://NeoHsu.github.io/</id>
  <author>
    <name><![CDATA[Neo Hsu]]></name>
    <email><![CDATA[NeoHsuDroid@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Talk About View Component on Android]]></title>
    <link href="http://NeoHsu.github.io/blog/2013/12/11/talk-about-view-component-on-android/"/>
    <updated>2013-12-11T22:51:29+08:00</updated>
    <id>http://NeoHsu.github.io/blog/2013/12/11/talk-about-view-component-on-android</id>
    <content type="html"><![CDATA[<p><img src="/images/SVG/1-talk-about-view-component-on-android.svg"></p>

<p>在 Android 開發中，我認為了解 View 的執行過程有助於提高介面呈現的效率，可以幫助一些複雜 Layout 在適當的時機中處理或是可以減少不必要的畫面重製，這些都是對於 View 的執行過程有很大的關聯</p>

<p>Android 中 View 的呈現主要經過 Mesure, Layout 和 Draw 三個過程，以下介紹各過程處理的事情與呼叫的方法</p>

<h2>Mesure</h2>

<p>此階段主要是負責計算 view 佔用的大小，簡單的說就是將 match_parent 和 wrap_content 轉成目前顯示的實際大小；透過 onMeasure(widthMeasureSpec, heightMeasureSpec) 方法去處理</p>

<blockquote><p>View 的大小是有 Parent View 和自己的大小决定而不是單一個 View 來决定，因此需要配合自己的 Sub-View 去做計算調整</p></blockquote>

<h2>Layout</h2>

<p>當 View 配置好大小後，便讀取設定好的 Layout 配置，將 Layout 佈局放到建立好的 View 中並計算出 View 在螢幕上的座標；透過 onLayout(int l, int t, int r, int b )方法去處理</p>

<blockquote><p>處理組件的佈局通常要重寫 onMesure 和 onLayout 這兩個方法</p></blockquote>

<h2>Draw</h2>

<p>Draw 過程中主要是先畫 Drawable 背景；需注意的是背景 Drawable 的實際大小會影響 View 的大小； Draw 過程會調用 onDraw(Canvas canvas) 方法去繪製背景，之後再透過 dispatchDraw(Canvas canvas) 方法分發給 Sub-View 進行繪製，值得注意的是 ViewGroup 在繪製時，如果它沒有背景則直接調用的是 dispatchDraw() 方法，繞過了 draw() 方法，當它有背景的時候就調用 draw() 方法，而 draw() 方法裡包含了 dispatchDraw() 方法的調用</p>

<blockquote><p>自定組件時通常是重寫 onDraw() 方法，而在 ViewGroup 上繪製東西的時候往往重寫的是 dispatchDraw() 方法</p></blockquote>

<h2>Summary</h2>

<p>Android 中所有畫面都是用 Canvas 根據座標去畫出來的結果，因此每次當 View 改變的時候，需要再去重新計算與繪製一個 View 來產生出畫面來</p>

<p>可想而知在 ListView 中，我們不斷地 onScroll 時，如果沒做一些效能處理與緩存的處理，它的運作模式將會是不斷地重新繪製畫面；因為當每次移動 Scroll 時都會進行 getView 的動作，之後便開始一連串的 View 行為的產生</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Error : ADB Server Didn't ACK on Windows]]></title>
    <link href="http://NeoHsu.github.io/blog/2013/11/28/solve-adb-server-didnt-ack-on-windows/"/>
    <updated>2013-11-28T23:40:27+08:00</updated>
    <id>http://NeoHsu.github.io/blog/2013/11/28/solve-adb-server-didnt-ack-on-windows</id>
    <content type="html"><![CDATA[<h1>Outline</h1>

<p>產生ADB Server didn&rsquo;t ACK 問題的主要原因為 ADB Server 的 Port 绑定失败，因此只需要關閉 Adb Server 所需綁定的 Port 上佔用的程序即可；我是在使用 Windows 系統時，自動啟動的 QQ 即時通訊軟體使 ADB Server 需綁定的 Port 被佔用，因此產生此問題</p>

<p></p>


<h2>Quit Eclipse &amp; Open Command Line</h2>

<p>關閉 Eclipse 使 android 的 adb與Eclipse 間的連結關閉，並打開 commad line ，切換目錄到 Android SDK 目錄中 platform-tools 資料夾裡</p>

<blockquote><p>切換到 platform-tools 資料夾中是為了使用 adb 工具，如果有有將 platform-tools 資料夾路徑加到環境變數中可以不需要切換</p></blockquote>

<p><div class="window">
          <nav class="control-window">
            <a href="#finder" class="close" data-rel="close">close</a>
            <a href="#" class="minimize">minimize</a>
            <a href="#" class="deactivate">deactivate</a>
          </nav>
          <h1 class="titleInside">Terminal</h1>
          <div class="container"><div class="terminal"><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>$</span>
<span class='line-number'>&nbsp;</span></pre></td><td class='code'><pre><code><span class='line command'>D:\Application\adt-bundle-windows\sdk\platform-tools > dir</span><span class='line output'>NOTICE.txt  adb  api  fastboot  source.properties  systrace</span></code></pre></td></tr></table></div></div>
        </div></p>

<h2>Turn Off ADB Server &amp; Turn On ADB Server Again</h2>

<p>關閉並重新啟動 ADB Server
<div class="window">
          <nav class="control-window">
            <a href="#finder" class="close" data-rel="close">close</a>
            <a href="#" class="minimize">minimize</a>
            <a href="#" class="deactivate">deactivate</a>
          </nav>
          <h1 class="titleInside">Terminal</h1>
          <div class="container"><div class="terminal"><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>$</span>
<span class='line-number'>$</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span></pre></td><td class='code'><pre><code><span class='line command'>adb kill-server</span><span class='line command'>adb start-server</p></span><span class='line output'>
</span><span class='line output'><h1>啟動服務成功顯示畫面如下</h1>
</span><span class='line output'>
</span><span class='line output'><ul>
</span><span class='line output'><li>daemon not running. starting it now on port 5037 *</li>
</span><span class='line output'><li>daemon started successfully *
</span><span class='line output'>
</span><span class='line output'><h1>啟動服務失敗顯示畫面如下</h1></li>
</span><span class='line output'><li>daemon not running. starting it now *</li>
</span><span class='line output'><li>ADB server didn&rsquo;t ACK *</li>
</span><span class='line output'><li>failed to start daemon *</span></code></pre></td></tr></table></div></div>
        </div></li>
</ul>


<h2>IF Failed To Start ADB Server</h2>

<p>如果前面步驟還沒成功啓動 ADB Server ，則需要查詢有哪些程序佔用了 ADB Server 的 port</p>

<blockquote><p>ADB Server 預設Port爲5037</p></blockquote>

<p><div class="window">
          <nav class="control-window">
            <a href="#finder" class="close" data-rel="close">close</a>
            <a href="#" class="minimize">minimize</a>
            <a href="#" class="deactivate">deactivate</a>
          </nav>
          <h1 class="titleInside">Terminal</h1>
          <div class="container"><div class="terminal"><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>$</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span></pre></td><td class='code'><pre><code><span class='line command'>netstat -ano | findstr &ldquo;5037&rdquo;</span><span class='line output'>TCP    127.0.0.1:1159         127.0.0.1:5037         ESTABLISHED     2492
</span><span class='line output'>TCP    127.0.0.1:5037         0.0.0.0:0              LISTENING       2796
</span><span class='line output'>TCP    127.0.0.1:5037         127.0.0.1:1159         ESTABLISHED     2796
</span><span class='line output'>TCP    127.0.0.1:5037         127.0.0.1:1349         TIME_WAIT       0
</span><span class='line output'>TCP    127.0.0.1:5037         127.0.0.1:1350         TIME_WAIT       0
</span><span class='line output'>TCP    127.0.0.1:5037         127.0.0.1:1353         TIME_WAIT       0</span></code></pre></td></tr></table></div></div>
        </div></p>

<h2>Kill Task &amp; Start ADB Server</h2>

<p>如果有查詢到佔用的 5037 port 的 Task，則用 taskkill 指令根據 PID 刪除它；並重新啟動 ADB Server
<div class="window">
          <nav class="control-window">
            <a href="#finder" class="close" data-rel="close">close</a>
            <a href="#" class="minimize">minimize</a>
            <a href="#" class="deactivate">deactivate</a>
          </nav>
          <h1 class="titleInside">Terminal</h1>
          <div class="container"><div class="terminal"><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>$</span>
<span class='line-number'>$</span>
<span class='line-number'>$</span>
<span class='line-number'>&nbsp;</span>
<span class='line-number'>&nbsp;</span></pre></td><td class='code'><pre><code><span class='line command'>taskkill /F /PID 2796</span><span class='line command'>taskkill /F /PID 2492</span><span class='line command'>adb start-server</span><span class='line output'>* daemon not running. starting it now on port 5037 *
</span><span class='line output'>* daemon started successfully *</span></code></pre></td></tr></table></div></div>
        </div></p>
]]></content>
  </entry>
  
</feed>
